<!DOCTYPE html>
<html>
<body>

<h1>Widget Page</h1>

<script>!function(a,b){a("squatch","https://d2rcp9ak152ke1.cloudfront.net/assets/javascripts/v2/squatch.min.js",b)}(function(a,b,c){var d,e,f;c["_"+a]={},c[a]={},c[a].ready=function(b){c["_" + a].ready =  c["_" + a].ready || [];c["_" + a].ready.push(b);},e=document.createElement("script"),e.async=1,e.src=b,f=document.getElementsByTagName("script")[0],f.parentNode.insertBefore(e,f)},this);</script>

<script>

window.squatch.ready(function(){

  //configure squatch.js for the tenant you are using       
  squatch.init({
      tenantAlias: 'test_axkthdflk7ebr'
  });

  //object containing the init parameters for squatch.js
  var initObj = {

    //the object for the user you want to upsert
    user: {                               
      id: 'abc_123',                      
      accountId: 'abc_123',       
      email: 'john@example.com',                
      firstName: 'John',       
      lastName: 'Doe',
      referable: false
    },
    engagementMedium: 'POPUP',
    widgetType: 'p/first-appointment-booking/w/referrerWidget',
    jwt: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7ImlkIjoiYWJjXzEyMyIsImFjY291bnRJZCI6ImFiY18xMjMiLCJlbWFpbCI6ImpvaG5AZXhhbXBsZS5jb20iLCJmaXJzdE5hbWUiOiJKb2huIiwibGFzdE5hbWUiOiJEb2UiLCJyZWZlcmFibGUiOiJmYWxzZSJ9fQ.dCYz2sTpmKsFFx5GtXBEcMbaMzBsR5A7laRIUZ0gpDs'
  };

  squatch.widgets().upsertUser(initObj).then(function(response) {
    user = response.user;
  }).catch(function(error){
    console.log(error);
  }); 
});

</script>

<button class="squatchpop">Referral Discount</button>

</body>
</html>
